<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Audio/Video Editor - Magic Loops</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/notyf@3/notyf.min.css">
  <link rel="stylesheet" href="/src/css/app.css">
</head>
<body>
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark mb-4">
    <div class="container">
      <a class="navbar-brand app__brand" href="javascript:void(0)">
        <i class="fas fa-waveform-path me-2"></i>
        AudioWave Editor
      </a>
      <button class="btn btn-primary ms-auto" id="start-over-btn">
        <i class="fas fa-refresh me-2"></i>
        Start Over
      </button>
    </div>
  </nav>

  <div class="container mb-5">
    <!-- Upload Panel -->
    <div class="app__panel" id="upload-panel">
      <h3 class="app__panel-title">
        <i class="fas fa-cloud-upload-alt me-2"></i>
        Upload Audio/Video File
      </h3>
      <div class="uploader__dropzone" id="drop-zone">
        <i class="fas fa-file-audio mb-3"></i>
        <h5>Drag & Drop file here</h5>
        <p class="text-muted">or</p>
        <button class="btn btn-secondary">Browse File</button>
        <input type="file" id="file-input" hidden accept=".mp3,.mp4,.m4a,.m4r,.ogg,.flac,.mov">
        <p class="mt-3 small text-muted">
          Supported formats: MP3, MP4, M4A, M4R, OGG, FLAC, MOV
        </p>
      </div>
      <div class="uploader__details" id="file-details">
        <div class="row align-items-center">
          <div class="col-md-6">
            <h5 id="file-name">filename.mp3</h5>
            <p id="file-info">Size: 2.3 MB | Duration: 3:45</p>
          </div>
          <div class="col" id="player-container">
            <audio controls id="audio-player"></audio>
            <video controls id="video-player"></video>
          </div>
        </div>
      </div>

      <!-- Optional second file for crossfade -->
      <div class="uploader__details" id="file-details-b" style="display:none;">
        <div class="row align-items-center">
          <div class="col-md-6">
            <h5 id="file-name-b">second-file.mp3</h5>
            <p id="file-info-b">Size: - | Duration: -</p>
            <button class="btn btn-secondary mt-2" id="browse-file-b">
              <i class="fas fa-file-import me-2"></i>
              Browse File B (for Crossfade)
            </button>
            <input type="file" id="file-input-b" hidden accept=".mp3,.mp4,.m4a,.m4r,.ogg,.flac,.mov">
          </div>
          <div class="col small text-muted">
            Used only when Crossfade &gt; 0s. Export is always audio-only.
          </div>
        </div>
      </div>
    </div>

    <!-- Editor Panels -->
    <div id="editor-panels" style="display: none;">
      <!-- Trimmer Panel -->
      <div class="app__panel">
        <h3 class="app__panel-title">
          <i class="fas fa-cut me-2"></i>
          Trimmer
        </h3>
        <div class="trimmer__timeline-container">
          <div class="trimmer__timeline" id="timeline">
            <div class="trimmer__waveform" id="waveform"></div>
            <div class="trimmer__handles">
              <div class="trimmer__handle trimmer__handle--start" id="start-handle"></div>
              <div class="trimmer__selection" id="timeline-selection"></div>
              <div class="trimmer__handle trimmer__handle--end" id="end-handle"></div>
            </div>
          </div>
        </div>
        <div class="row mt-3">
          <div class="col-md-6">
            <div class="input-group mb-3">
              <span class="input-group-text">Start Time</span>
              <input type="text" class="form-control trimmer__time-input" id="start-time" value="00:00">
            </div>
          </div>
          <div class="col-md-6">
            <div class="input-group mb-3">
              <span class="input-group-text">End Time</span>
              <input type="text" class="form-control trimmer__time-input" id="end-time" value="00:00">
            </div>
          </div>
        </div>
      </div>

      <!-- Equalizer Panel -->
      <div class="app__panel">
        <h3 class="app__panel-title">
          <i class="fas fa-sliders-h me-2"></i>
          10-Band Equalizer
        </h3>
        <div class="eq__preset">
          <select class="form-select" id="eq-preset">
            <option value="flat">Flat</option>
            <option value="rock">Rock</option>
            <option value="jazz">Jazz</option>
            <option value="classical">Classical</option>
            <option value="custom">Custom</option>
          </select>
          <button class="btn btn-secondary" id="save-preset-btn">Save Preset</button>
        </div>
        <div class="eq__sliders">
          <div class="eq__slider-container">
            <input type="range" class="eq__slider" min="-12" max="12" value="0" id="eq-31">
            <div class="eq__label">31Hz</div>
            <div class="eq__value">0 dB</div>
          </div>
          <div class="eq__slider-container">
            <input type="range" class="eq__slider" min="-12" max="12" value="0" id="eq-62">
            <div class="eq__label">62Hz</div>
            <div class="eq__value">0 dB</div>
          </div>
          <div class="eq__slider-container">
            <input type="range" class="eq__slider" min="-12" max="12" value="0" id="eq-125">
            <div class="eq__label">125Hz</div>
            <div class="eq__value">0 dB</div>
          </div>
          <div class="eq__slider-container">
            <input type="range" class="eq__slider" min="-12" max="12" value="0" id="eq-250">
            <div class="eq__label">250Hz</div>
            <div class="eq__value">0 dB</div>
          </div>
          <div class="eq__slider-container">
            <input type="range" class="eq__slider" min="-12" max="12" value="0" id="eq-500">
            <div class="eq__label">500Hz</div>
            <div class="eq__value">0 dB</div>
          </div>
          <div class="eq__slider-container">
            <input type="range" class="eq__slider" min="-12" max="12" value="0" id="eq-1k">
            <div class="eq__label">1kHz</div>
            <div class="eq__value">0 dB</div>
          </div>
          <div class="eq__slider-container">
            <input type="range" class="eq__slider" min="-12" max="12" value="0" id="eq-2k">
            <div class="eq__label">2kHz</div>
            <div class="eq__value">0 dB</div>
          </div>
          <div class="eq__slider-container">
            <input type="range" class="eq__slider" min="-12" max="12" value="0" id="eq-4k">
            <div class="eq__label">4kHz</div>
            <div class="eq__value">0 dB</div>
          </div>
          <div class="eq__slider-container">
            <input type="range" class="eq__slider" min="-12" max="12" value="0" id="eq-8k">
            <div class="eq__label">8kHz</div>
            <div class="eq__value">0 dB</div>
          </div>
          <div class="eq__slider-container">
            <input type="range" class="eq__slider" min="-12" max="12" value="0" id="eq-16k">
            <div class="eq__label">16kHz</div>
            <div class="eq__value">0 dB</div>
          </div>
        </div>
      </div>

      <!-- Fade Controls Panel -->
      <div class="app__panel">
        <h3 class="app__panel-title">
          <i class="fas fa-volume-down me-2"></i>
          Fade Controls
        </h3>
        <div class="row">
          <div class="col-md-4 mb-3">
            <label for="fade-in" class="form-label">Fade In (seconds)</label>
            <input type="range" class="form-range fade__slider" min="0" max="10" step="0.1" value="0" id="fade-in">
            <div class="d-flex justify-content-between">
              <span>0s</span>
              <span id="fade-in-value">0s</span>
              <span>10s</span>
            </div>
          </div>
          <div class="col-md-4 mb-3">
            <label for="fade-out" class="form-label">Fade Out (seconds)</label>
            <input type="range" class="form-range fade__slider" min="0" max="10" step="0.1" value="0" id="fade-out">
            <div class="d-flex justify-content-between">
              <span>0s</span>
              <span id="fade-out-value">0s</span>
              <span>10s</span>
            </div>
          </div>
          <div class="col-md-4 mb-3">
            <label for="crossfade" class="form-label">Crossfade (seconds)</label>
            <input type="range" class="form-range fade__slider" min="0" max="10" step="0.1" value="0" id="crossfade">
            <div class="d-flex justify-content-between">
              <span>0s</span>
              <span id="crossfade-value">0s</span>
              <span>10s</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Export Panel -->
      <div class="app__panel">
        <h3 class="app__panel-title">
          <i class="fas fa-file-export me-2"></i>
          Export
        </h3>
        <div class="row align-items-end">
          <div class="col-md-6 mb-3">
            <label for="output-format" class="form-label">Output Format</label>
            <select class="form-select" id="output-format">
              <option value="mp3">MP3</option>
              <option value="mp4">MP4</option>
              <option value="m4a">M4A</option>
              <option value="m4r">M4R</option>
            </select>
          </div>
          <div class="col-md-3 mb-3">
            <button class="btn btn-secondary w-100" id="preview-btn">
              <i class="fas fa-play me-2"></i>
              Preview
            </button>
          </div>
          <div class="col-md-3 mb-3">
            <button class="btn btn-primary w-100" id="export-btn">
              <i class="fas fa-file-export me-2"></i>
              Export File
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Loading Overlay -->
  <div class="loading" id="loading-overlay">
    <div class="loading__progress">
      <h5>Processing...</h5>
      <div class="loading__bar" id="progress-bar"></div>
      <div class="loading__text" id="progress-text">0%</div>
    </div>
  </div>

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/notyf@3/notyf.min.js"></script>

  <script type="importmap">
    {
      "imports": {
        "@ffmpeg/ffmpeg": "/node_modules/@ffmpeg/ffmpeg/dist/esm/index.js",
        "@ffmpeg/util": "/node_modules/@ffmpeg/util/dist/esm/index.js"
      }
    }
  </script>

  <script type="module" src="/src/js/app.js"></script>
</body>
</html>